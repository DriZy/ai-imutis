#apiVersion: autoscaling/v2
#kind: HorizontalPodAutoscaler
#metadata:
#  name: api-hpa
#  namespace: ai-imutis
#spec:
#  scaleTargetRef:
#    apiVersion: apps/v1
#    kind: Deployment
#    name: api
#  minReplicas: 3
#  maxReplicas: 10
#  metrics:
#  - type: Resource
#    resource:
#      name: cpu
#      target:
#        type: Utilization
#        averageUtilization: 70
#  - type: Resource
#    resource:
#      name: memory
#      target:
#        type: Utilization
#        averageUtilization: 80
#  - type: Pods
#    pods:
#      metric:
#        name: http_requests_per_second
#      target:
#        type: AverageValue
#        averageValue: "1000"
#  behavior:
#    scaleDown:
#      stabilizationWindowSeconds: 300
#      policies:
#      - type: Percent
#        value: 50
#        periodSeconds: 60
#      - type: Pods
#        value: 1
#        periodSeconds: 60
#      selectPolicy: Min
#    scaleUp:
#      stabilizationWindowSeconds: 0
#      policies:
#      - type: Percent
#        value: 100
#        periodSeconds: 30
#      - type: Pods
#        value: 2
#        periodSeconds: 60
#      selectPolicy: Max
#
#---
#apiVersion: autoscaling/v2
#kind: HorizontalPodAutoscaler
#metadata:
#  name: postgres-hpa
#  namespace: ai-imutis
#spec:
#  scaleTargetRef:
#    apiVersion: apps/v1
#    kind: StatefulSet
#    name: postgres
#  minReplicas: 1
#  maxReplicas: 3
#  metrics:
#  - type: Resource
#    resource:
#      name: cpu
#      target:
#        type: Utilization
#        averageUtilization: 80
#  - type: Resource
#    resource:
#      name: memory
#      target:
#        type: Utilization
#        averageUtilization: 85
#  behavior:
#    scaleDown:
#      stabilizationWindowSeconds: 600
#      policies:
#      - type: Pods
#        value: 1
#        periodSeconds: 300
#    scaleUp:
#      stabilizationWindowSeconds: 300
#      policies:
#      - type: Pods
#        value: 1
#        periodSeconds: 120
#
#---
#apiVersion: autoscaling/v2
#kind: HorizontalPodAutoscaler
#metadata:
#  name: redis-hpa
#  namespace: ai-imutis
#spec:
#  scaleTargetRef:
#    apiVersion: apps/v1
#    kind: StatefulSet
#    name: redis
#  minReplicas: 1
#  maxReplicas: 3
#  metrics:
#  - type: Resource
#    resource:
#      name: cpu
#      target:
#        type: Utilization
#        averageUtilization: 75
#  - type: Resource
#    resource:
#      name: memory
#      target:
#        type: Utilization
#        averageUtilization: 80
